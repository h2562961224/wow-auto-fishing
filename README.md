# WoW 自动钓鱼工具

一个用于魔兽世界的自动钓鱼辅助工具，通过检测系统音频来自动执行收杆操作。

## 功能特点

- **声音检测**: 自动检测鱼上钩的声音，触发收杆
- **自动流程**: 自动执行抛竿、等待、收杆的循环
- **定时上饵**: 支持每隔一段时间自动执行上饵动作
- **随机延迟**: 所有操作都有随机延迟，模拟人类操作
- **可配置**: 支持自定义快捷键、延迟时间、灵敏度等参数
- **图形界面**: 提供友好的 GUI 界面
- **跨平台**: 支持 Windows 和 macOS

## 系统要求

- **Windows 10/11** 或 **macOS 10.15+**
- Python 3.10+
- 音频捕获设备（见下方说明）

## 安装

### 方式一：下载打包好的程序（推荐）

1. 前往 [Releases](../../releases) 或 [Actions](../../actions) 页面
2. 下载对应系统的可执行文件：
   - Windows 单文件版: `WoW自动钓鱼.exe`（方便，但可能有兼容性问题）
   - Windows 文件夹版: `WoW自动钓鱼-文件夹版.zip`（更稳定，解压后运行）
   - macOS: `WoW自动钓鱼.app`
3. 直接运行即可

**Windows 运行报错？** 如果遇到 DLL 相关错误：
1. 优先尝试「文件夹版」
2. 安装 [Visual C++ Redistributable](https://aka.ms/vs/17/release/vc_redist.x64.exe)

### 方式二：从源码运行

1. 克隆或下载本项目

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行程序：
```bash
python main.py
```

### 方式三：自行打包

```bash
# 安装 PyInstaller
pip install pyinstaller

# 打包（在对应系统上执行）
pyinstaller --name "WoW自动钓鱼" --onefile --windowed main.py
```

**macOS 首次运行注意**：需要在「系统偏好设置 → 安全性与隐私 → 隐私 → 辅助功能」中授权程序，否则无法发送按键。

## 使用说明

### 前置准备

#### Windows 用户

1. **启用立体声混音**:
   - 右键点击任务栏音量图标 → 声音设置
   - 找到"立体声混音"设备，启用并设为默认设备
   - 如果没有立体声混音，可能需要在声卡设置中启用

#### macOS 用户

macOS 默认不支持捕获系统音频，需要安装虚拟音频设备：

1. **安装 BlackHole**（推荐，免费开源）:
   ```bash
   brew install blackhole-2ch
   ```
   或从 https://github.com/ExistentialAudio/BlackHole 下载

2. **配置多输出设备**:
   - 打开「应用程序 → 实用工具 → 音频 MIDI 设置」
   - 点击左下角 + 号，选择「创建多输出设备」
   - 勾选「BlackHole 2ch」和你的扬声器/耳机
   - 右键点击多输出设备，选择「使用此设备进行声音输出」

3. **在程序中选择设备**:
   - 启动程序后，在「音频设备」下拉框中选择「BlackHole 2ch」
   - 带 ★ 标记的设备是推荐的虚拟音频设备

#### 通用设置

1. **游戏内设置**:
   - 确保游戏内声音已开启
   - 建议关闭背景音乐，只保留音效
   - 设置好交互键（默认 F 键）

2. **准备宏**:
   - 前置动作宏（上饵等）
   - 钓鱼宏

### 快捷键设置

| 设置项 | 默认值 | 说明 |
|--------|--------|------|
| 前置动作键 | 1 | 执行上饵等前置动作的快捷键 |
| 钓鱼键 | 2 | 执行钓鱼（抛竿）的快捷键 |
| 交互键 | F | 收杆/拾取的交互键 |

### 参数说明

| 参数 | 默认值 | 说明 |
|------|--------|------|
| 声音灵敏度 | 50% | 越高越容易触发，建议先校准 |
| 上饵间隔 | 15 分钟 | 鱼饵持续时间 |
| 超时时间 | 20 秒 | 超过此时间未检测到声音则重新抛竿 |
| 收杆延迟 | 200-600ms | 检测到声音后的随机延迟 |
| 抛竿延迟 | 500-1500ms | 收杆后到下次抛竿的随机延迟 |

### 使用步骤

1. 启动程序
2. 根据需要调整快捷键和参数
3. 点击"校准"按钮校准声音（保持安静环境）
4. 切换到游戏窗口
5. 点击"开始钓鱼"
6. 程序会自动执行钓鱼流程

## 项目结构

```
wow-auto-fishing/
├── main.py                 # 程序入口
├── requirements.txt        # 依赖列表
├── config.json            # 用户配置（运行后生成）
├── src/
│   ├── gui/
│   │   └── main_window.py  # 图形界面
│   ├── core/
│   │   ├── fishing_bot.py  # 钓鱼核心逻辑
│   │   ├── sound_detector.py # 声音检测
│   │   └── key_sender.py   # 按键发送
│   └── utils/
│       └── config.py       # 配置管理
└── README.md
```

## 注意事项

- 本工具仅供学习和研究使用
- 使用第三方工具可能违反游戏服务条款，请自行承担风险
- 建议在非高峰时段使用，避免长时间挂机
- 请确保系统音频设备配置正确

## 故障排除

### 声音检测不工作

**Windows:**
1. 检查是否启用了立体声混音
2. 尝试点击"校准"按钮
3. 调高声音灵敏度
4. 确保游戏声音已开启

**macOS:**
1. 确保已安装 BlackHole 并正确配置多输出设备
2. 检查系统音频输出是否设置为多输出设备
3. 在程序中选择正确的 BlackHole 设备
4. 尝试点击"校准"按钮
5. 调高声音灵敏度

### 按键没有反应

**Windows:**
1. 确保游戏窗口在前台
2. 检查快捷键设置是否正确
3. 尝试以管理员身份运行程序

**macOS:**
1. 确保游戏窗口在前台
2. 检查「系统偏好设置 → 安全性与隐私 → 隐私 → 辅助功能」中是否授权了程序
3. 如果使用 Terminal 运行，需要授权 Terminal
4. 检查快捷键设置是否正确

## 许可证

MIT License
